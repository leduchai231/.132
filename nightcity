-- ğŸ” Kiá»ƒm tra ngÆ°á»i dÃ¹ng Ä‘Ã£ nháº­p key chÆ°a
if not getgenv().key or type(getgenv().key) ~= "string" or #getgenv().key < 4 then
    warn("âŒ Báº¡n chÆ°a nháº­p key há»£p lá»‡! Vui lÃ²ng dÃ¹ng: getgenv().key = \"KEY_CUA_BAN\" trÆ°á»›c khi cháº¡y script.")
    return
end

print("ğŸ”‘ Key Ä‘Æ°á»£c nháº­p tá»« ngÆ°á»i dÃ¹ng:", getgenv().key)

-- ğŸ‘¤ Láº¥y tÃªn player Ä‘ang cháº¡y script
local player = game:GetService("Players").LocalPlayer
local playerName = player and player.Name or "KhÃ´ng xÃ¡c Ä‘á»‹nh"
print("ğŸ‘¤ Theo dÃµi level tá»« Billboard cá»§a báº¡n:", playerName)

-- ğŸ¯ HÃ m loáº¡i bá» RichText vÃ  tÃ¡ch level
local function parseLevel(text)
    local clean = text:gsub("<[^>]->", "")
    local level = string.match(clean, "Lv%. (%d+)")
    return level
end

-- ğŸ“ ÄÆ°á»ng dáº«n Ä‘áº¿n TextLabel chá»©a Level
local success, label = pcall(function()
    return workspace:WaitForChild("CharacterFolder", 10)
        :WaitForChild(playerName, 10)
        :WaitForChild("NameBillboard", 10)
        :WaitForChild("NameFrame", 10)
        :WaitForChild("LevelFrame", 10)
        :WaitForChild("TextLabel", 10)
        :WaitForChild("TextLabel", 10)
end)

if not success or not label or not label:IsA("TextLabel") then
    warn("âŒ KhÃ´ng tÃ¬m tháº¥y TextLabel cáº¥p Ä‘á»™ cá»§a báº¡n!")
    return
end

-- âœ… Theo dÃµi realtime khi Text thay Ä‘á»•i
local currentLevel = parseLevel(label.Text)
if currentLevel then
    print("â­ Level ban Ä‘áº§u:", currentLevel)
end

label:GetPropertyChangedSignal("Text"):Connect(function()
    local newLevel = parseLevel(label.Text)
    if newLevel and newLevel ~= currentLevel then
        currentLevel = newLevel
        print("ğŸ”„ Level Ä‘Ã£ thay Ä‘á»•i! Level má»›i:", newLevel)
    end
end)

print("âœ… Äang theo dÃµi Level tá»« nhÃ¢n váº­t chÃ­nh cá»§a báº¡n...")

-- ğŸ” Tá»± Ä‘á»™ng kiá»ƒm tra láº¡i level sau má»—i 5 phÃºt
spawn(function()
    while true do
        wait(300)
        local latestLevel = parseLevel(label.Text)
        if latestLevel and latestLevel ~= currentLevel then
            currentLevel = latestLevel
            print("â° [5 PHÃšT] Level Ä‘Ã£ thay Ä‘á»•i! Level má»›i:", currentLevel)
        else
            print("â° [5 PHÃšT] Level váº«n lÃ :", currentLevel)
        end
    end
end)
